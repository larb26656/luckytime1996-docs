---
const avatarMap = {
  me: "/avatar/me.png",
  blackCat: "/avatar/black-cat.png",
  whiteCat: "/avatar/white-cat.png",
};

type AvatarKey = keyof typeof avatarMap;

interface Props {
  message: string;
  avatarKey: AvatarKey;
  isFromMe?: boolean;
}

const { message, avatarKey, isFromMe = false } = Astro.props as Props;
const avatarUrl = avatarMap[avatarKey];
const avatarClass = `mt-2 ${isFromMe ? "" : "scale-x-[-1]"}`;
const rowClass = `my-3 flex items-start gap-3 ${isFromMe ? "flex-row-reverse" : ""}`;
const bubbleClass =
  "max-w-[70ch] m-0 rounded-2xl border border-neutral-200 bg-neutral-100 px-4 py-2 text-[0.95rem] leading-relaxed text-neutral-900 shadow-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100 relative z-10";
---

<div class={rowClass}>
  <img
    src={avatarUrl}
    alt={`Avatar ${avatarKey}`}
    width="32"
    height="32"
    loading="lazy"
    class={avatarClass}
  />
  <div class={bubbleClass}>
    {message}
  </div>
</div>
