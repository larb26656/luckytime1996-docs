---
title: SSL
description: A cheatsheet of ssl
---

## SSL (Secure Sockets Layer) 

‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏Å‡πà‡∏≤ ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó Netscape ‡πÉ‡∏ô‡∏¢‡∏∏‡∏Ñ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ô‡∏¢‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏¥‡∏î‡∏õ‡∏≤‡∏Å‡∏ß‡πà‡∏≤ ‚ÄúSSL‚Äù ‡∏≠‡∏¢‡∏π‡πà

## TLS (Transport Layer Security)

‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å SSL ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

> ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ SSL Certificate ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ TLS Certificate

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ssl

‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö:

```
http://example.com
```

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î ‡πÉ‡∏Ñ‡∏£‡∏î‡∏±‡∏Å Wi-Fi ‡∏Å‡πá‡πÄ‡∏´‡πá‡∏ô password ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢

``` mermaid
sequenceDiagram
    participant User
    participant Attacker (Wi-Fi Sniffer)
    participant Server

    User->>Server: ‡∏™‡πà‡∏á username & password (Plain Text)
    Attacker-->>User: ‡∏î‡∏±‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á
    Attacker-->>Server: ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î
    Server-->>User: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö (Plain Text)
```

‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô:

```
https://example.com
```

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å ‚Äú‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‚Äù
‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏î‡∏±‡∏Å‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡πá‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å

``` mermaid
sequenceDiagram
    participant User
    participant Attacker (Wi-Fi Sniffer)
    participant Server

    User->>Server: ‡∏™‡πà‡∏á username & password (Plain Text)
    Attacker-->>User: ‡∏î‡∏±‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á
    Attacker-->>Server: ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î
    Server-->>User: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö (Plain Text)
```

## Terminology

### CA (Certificate Authority)

‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á (Certificate) ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô ‚Äú‡∏Å‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‚Äù ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î HTTPS ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏Ç‡∏≠‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏à‡∏≤‡∏Å CA ‡∏Å‡πà‡∏≠‡∏ô
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á CA ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô:
   - Let‚Äôs Encrypt
   - DigiCert
	- GlobalSign

CA ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏∞‡πÑ‡∏£?
	1.	‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°
	2.	‡∏≠‡∏≠‡∏Å Certificate ‡πÉ‡∏´‡πâ
	3.	‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ (Digital Signature) ‡∏•‡∏á‡πÉ‡∏ô Certificate

‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏Ç‡∏≠‡∏á CA ‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà browser ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠

### CSR (Certificate Signing Request)

‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‚Äù ‡∏ó‡∏µ‡πà Server ‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÉ‡∏´‡πâ CA ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà CA ‡∏à‡∏∞‡∏≠‡∏≠‡∏Å Certificate ‡πÉ‡∏´‡πâ
Server ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå CSR ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô
‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏°‡∏µ:
   - Public Key
	- Domain (‡πÄ‡∏ä‡πà‡∏ô example.com)
	- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Organization (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
	- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Private Key

### Certificate

Certificate ‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‚Äù
‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏°‡∏µ:
   - Domain (‡πÄ‡∏ä‡πà‡∏ô example.com)
	- Public Key
	- ‡∏ä‡∏∑‡πà‡∏≠ CA ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ
	- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•
	- ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏

Browser ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á

### TLS Handshake

‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà client ‡∏Å‡∏±‡∏ö server:
	1.	‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
	2.	‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏•‡∏±‡∏ö‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô
	3.	‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### Session Key

‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á

‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:
	- ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å (‡πÉ‡∏ä‡πâ symmetric encryption ‡πÄ‡∏ä‡πà‡∏ô AES)
	- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å connection

### Cipher Suite

‡∏Ñ‡∏∑‡∏≠‡∏ä‡∏∏‡∏î algorithm ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô TLS ‡πÄ‡∏ä‡πà‡∏ô:

```
TLS_AES_128_GCM_SHA256
```

‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ:
	- ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô (AES)
	- ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ hash ‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô (SHA256)
	- ‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô

### Private Key

   - ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á Server
	- ‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏±‡πà‡∏ß‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î
	- ‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô

### Public Key

	- ‡πÉ‡∏™‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Certificate
	- ‡πÅ‡∏à‡∏Å‡πÉ‡∏´‡πâ client ‡πÑ‡∏î‡πâ
	- ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≠‡∏ô handshake

### X.509

X.509 ‡∏Ñ‡∏∑‡∏≠‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (standard) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Digital Certificate
‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö SSL/TLS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Ç‡∏≠‡∏á Server ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£

> ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ HTTPS ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ SSL/TLS

## File ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ ssl ‡∏´‡∏£‡∏∑‡∏≠ https ‡πÄ‡∏£‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 3 ‡∏™‡πà‡∏ß‡∏ô‡∏î‡∏±‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ

1. private.key (private key)
   - ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á Server
   - ‡πÉ‡∏ä‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Ç‡∏≠‡∏á Server ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô TLS Handshake
   - ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ session key
	- **‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î**
2. server.csr (CSR)
   ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å Private Key
	- ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
      - Public Key
      - Domain / Organization
      - ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏à‡∏≤‡∏Å Private Key
	- ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ CA ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏≠‡∏≠‡∏Å Certificate
	- ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ CA ‡πÑ‡∏î‡πâ
3. cert.csr (cert)
   - ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà CA ‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ
   - ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏°‡∏µ:
      - Public Key
      - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡πÄ‡∏°‡∏ô
      - ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏à‡∏≤‡∏Å CA
	- ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡πâ Client ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Server ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á
	- ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Handshake

Self-sign ‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‚Äã CA

## ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á private key ‡∏Å‡∏±‡∏ö public key (CSR)

| Field | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏´‡∏° |
|-------|-----------|----------|------------|
| Country Name (2 letter code) | ‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ï‡∏≤‡∏° ISO 3166 | TH | ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô |
| State or Province Name | ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î / ‡∏£‡∏±‡∏ê (‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°) | Bangkok | ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô |
| Locality Name | ‡πÄ‡∏°‡∏∑‡∏≠‡∏á / ‡πÄ‡∏Ç‡∏ï | Chatuchak | ‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î |
| Organization Name | ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏° | Example Company Co., Ltd. | ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö OV / EV) |
| Organizational Unit Name | ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏Å | IT Department | ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô |
| Common Name | Domain ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö SSL | example.com | ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å |
| Email Address | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ | admin@example.com | ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô |

## Flow ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠ cert

``` mermaid
flowchart TD
    A[Start] --> B[Generate Private Key]
    B --> C[Generate CSR using Private Key]
    C --> D[Send CSR to CA]
    D --> E[CA Validate Domain or Organization]
    E --> F{Validation Passed}
    F -- No --> G[Fix Information and Retry]
    G --> C
    F -- Yes --> H[CA Issue SSL Certificate]
    H --> I[Receive Certificate]
    I --> J[Install Certificate on Server]
    J --> K[Configure Server with Private Key]
    K --> L[Restart Web Server]
    L --> M[HTTPS Ready]
```

## Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á TLS 
``` mermaid
sequenceDiagram
    participant U as User Browser / Client
    participant S as Server (API)

    Note over U,S: üîê TLS Handshake Phase

    U->>S: ClientHello (TLS version, cipher suites, random)
    S->>U: ServerHello (chosen cipher suite, random)
    S->>U: Certificate (public key)
    S->>U: ServerHelloDone

    U->>U: Verify certificate (CA, domain, expiry)
    U->>S: ClientKeyExchange (pre-master secret encrypted with public key)
    U->>S: ChangeCipherSpec
    U->>S: Finished (encrypted)

    S->>S: Decrypt pre-master with private key
    S->>S: Generate session key
    S->>U: ChangeCipherSpec
    S->>U: Finished (encrypted)

    Note over U,S: üîê Secure Channel Established (Session Key)

    Note over U,S: üì¶ HTTPS Login Request

    U->>S: POST /login (username + password) üîí encrypted
    S->>S: Decrypt request using session key
    S->>S: Validate username/password
    S->>S: Generate JWT / Session
    S->>U: Response (token) üîí encrypted
```

```mermaid
flowchart TD

    subgraph TLS Handshake
        A[ClientHello]
        B[ServerHello]
        C[Certificate ‡∏™‡πà‡∏á Public Key]
        D[Client ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Certificate]
        E[Client ‡∏™‡πà‡∏á Pre-Master Secret ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢ Public Key]
        F[Server ‡πÉ‡∏ä‡πâ Private Key ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™]
        G[‡∏™‡∏£‡πâ‡∏≤‡∏á Session Key]
        H[Secure Channel Established]
        
        A --> B --> C --> D --> E --> F --> G --> H
    end

    subgraph HTTPS Login
        I[Client ‡∏™‡πà‡∏á POST /login]
        J[‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢ Session Key]
        K[Server ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™]
        L[Validate Username/Password]
        M[Generate Token]
        N[Response ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™]

        H --> I --> J --> K --> L --> M --> N
    end
```    

TLS Handshake ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏ï‡∏≠‡∏ô ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á TLS connection ‡πÉ‡∏´‡∏°‡πà‚Äù ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô connection ‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ session key ‡πÄ‡∏î‡∏¥‡∏° 

‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠:
	- ‡πÄ‡∏õ‡∏¥‡∏î tab ‡πÉ‡∏´‡∏°‡πà
	- ‡πÄ‡∏õ‡∏¥‡∏î connection ‡πÉ‡∏´‡∏°‡πà
	- connection timeout
	- server ‡∏õ‡∏¥‡∏î connection
	- HTTP/1.1 ‡πÑ‡∏°‡πà‡∏°‡∏µ keep-alive
	- load balancer ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô backend‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤ connection ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î


``` mermaid
flowchart TD

A[User ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö] --> B[TLS Handshake]
B --> C[Derive Session Keys]
C --> D[Connection Established]

D --> E[Request 1 üîí ‡πÉ‡∏ä‡πâ Application Traffic Key]
D --> F[Request 2 üîí ‡πÉ‡∏ä‡πâ Key ‡πÄ‡∏î‡∏¥‡∏°]
D --> G[Request 3 üîí ‡πÉ‡∏ä‡πâ Key ‡πÄ‡∏î‡∏¥‡∏°]

G --> H{Connection ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°?}

H -->|Yes| D
H -->|No| I[TLS Handshake ‡πÉ‡∏´‡∏°‡πà]
```

## Openssl command
```bash
# generate public key ‡πÅ‡∏•‡∏∞ private key ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö passphrase
openssl req -newkey rsa:2048 -keyout private.key -out server.csr -nodes

# self sign cert
openssl x509 -req -in server.pem -signkey private.key -out cert.csr

# ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• crs
openssl x509 -in server.csr -text

# ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• cert
openssl x509 -in cert.csr -text
```
